
#!/bin/bash

# installing nodejs on ubuntu
curl -sL https://deb.nodesource.com/setup_14.x | sudo -E bash -
sudo apt-get install -y nodejs

# installing mongodb
wget -qO - https://www.mongodb.org/static/pgp/server-4.2.asc | sudo apt-key add -
echo "deb [ arch=amd64,arm64 ] https://repo.mongodb.org/apt/ubuntu bionic/mongodb-org/4.2 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-4.2.list
sudo apt-get update
sudo apt-get install -y mongodb-org
sudo apt-get install -y npm

#setting up the repo
git clone https://github.com/timethethyme/CADExercise1.git
cd CADExercise1/backend/
npm install
sudo npm i -g nodemon
sudo npm i -g ejs
cd ..
cd ..
chmod 777 -R CADExercise1
cd CADExercise1/backend/

#ngrok for exposing localhost
sudo npm install --unsafe-perm -g ngrok

#===============================
#=========REPLACE HERE==========
#===============================
ngrok authtoken XXXX

# for starting the db
mkdir -p ./data
mongod --port 27017 --dbpath ./data &
sleep 6s
nodemon server.js &
ngrok http -region=eu 3000
